---
title: Project Service Automation での 請求
description: このトピックでは、請求に関する情報を提供します。
author: rumant
manager: kfend
ms.custom:
- dyn365-projectservice
ms.date: 08/03/2020
ms.topic: article
ms.service: business-applications
ms.author: rumant
audience: Admin
search.audienceType:
- admin
- customizer
- enduser
search.app:
- D365PS
- ProjectOperations
ms.openlocfilehash: f8107a660f9993c7b6a32d69047a81fb7e0abef8
ms.sourcegitcommit: 5c4c9bf3ba018562d6cb3443c01d550489c415fa
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/16/2020
ms.locfileid: "4079332"
---
# <a name="invoicing-in-project-service-automation"></a>Project Service Automation での 請求

[!INCLUDE[cc-applies-to-psa-app-3.x](../includes/cc-applies-to-psa-app-3x.md)]

Dynamics 365 Project Service Automation での請求は、プロジェクト管理者が顧客に対する請求書を作成する前に、第 2 レベルの承認を与えるので便利です。 プロジェクト チーム メンバーが送信する時間と経費のエントリが承認されると、第 1 レベルの承認が完了します。

PSAは、次の理由により、顧客向け請求書を生成するようには設計されていません:

- 税務情報は含まれていません。
- 正しく設定された為替レートを使用して、他の通貨を請求通貨に変換することはできません。
- 請求書を印刷できるように正しく書式設定できません。

代わりに、財務または会計システムを使用して、PSA で生成された請求書候補の情報を使用して顧客向け請求を作成できます。

## <a name="creating-project-invoices-in-psa"></a>PSA でのプロジェクト請求書の作成

プロジェクトの請求書は 1 つずつ、または一括して作成できます。 手動で作成できます。また、自動実行で生成するように設定することもできます。

### <a name="manually-create-project-invoices-in-psa"></a>PSA を使用してプロジェクト請求書を手動で作成する

**プロジェクト契約** 一覧ページから、プロジェクト契約ごとに個別にプロジェクト請求書を作成することも、複数のプロジェクト契約に対して一括で請求書を作成することもできます。

特定のプロジェクト契約の請求書を作成するには、このステップを実行します。

- **プロジェクト契約** リスト ページで、プロジェクト契約を開き、 **請求書の​​作成** を選択します。

    ![特定のプロジェクト契約に対するプロジェクト請求書の作成](media/CreateProjectInvoicesOneByOne.png)

    ステータスが **請求準備完了** の選択したプロジェクト契約の全トランザクションに対して請求書が生成されます。 これらのトランザクションには、時間、経費、マイルストーン、製品ベースの契約品目が含まれます。

一括で請求書を作成するには、次の手順に実行します。

1. **プロジェクト契約** 一覧ページで、請求書を作成する必要のあるプロジェクト契約を 1 つ以上選択し、 **プロジェクト請求書の作成** を選択します。

    ![プロジェクト請求書の一括作成](media/CreateProjectInvoicesBulk.png)

    警告メッセージは、請求書が作成される前に遅延が発生する可能性があることを通知します。 プロセスも表示されます。

2. **OK** を選択して、メッセージ ボックスを閉じます。

    ステータスが **請求準備完了** の契約品目の全トランザクションに対して請求書が生成されます。 これらのトランザクションには、時間、経費、マイルストーン、製品ベースの契約品目が含まれます。

3. 生成された請求書を表示するには、 **営業** \> **請求先** \> **請求書** の順に移動します。 プロジェクト契約ごとに 1 つの請求書が表示されます。

### <a name="set-up-automated-creation-of-project-invoices-in-psa"></a>PSA でプロジェクト請求書の自動作成を設定

PSAで実行された自動化請求を設定するには、次の手順に従います。

1. **Project Service** \> **設定** \> **バッチ ジョブ** に移動します。
2. 一括ジョブを作成して、 **PSA 請求書の作成** と名前をつけます。 バッチ ジョブの名前に、「請求書の作成」という語句を含める必要があります。
3. **ジョブの種類** フィールドで、 **なし** を選択します。 既定で、 **頻度 毎日** および **アクティブ** オプションは **はい** に設定されています。
4. **ワークフローの実行** を選択します。 **レコードの検索** ダイアログ ボックスで、 3 つのワークフローが表示されます:

    - ProcessRunCaller
    - ProcessRunner
    - UpdateRoleUtilization

5. **ProcessRunCaller** を選択し、そして **追加** を選択します。
6. 次のダイアログ ボックスで、 **OK** を選択します。 **スリープ** ワークフローの後に、 **プロセス** ワークフローが続きます。

    ステップ 5 で、 **ProcessRunner** を選択することもできます。 **OK** を選択すると、 **プロセス** ワークフロー の後には、 **スリープ** ワークフローが続きます。

**ProcessRunCaller** および **ProcessRunner** ワークフローは、請求書を作成します。 **ProcessRunCaller** は **ProcessRunner** を呼び出します。 **ProcessRunner** は、実際に請求書を作成するワークフローです。 請求書を作成する必要のあるすべての契約品目を調べ、それらの明細の請求書を作成します。 契約書を作成する契約品目を決定するために、ジョブは契約品目の請求書の実行日を参照します。 1 つの契約に属する契約品目の請求書実行日が同じ場合、トランザクションは、 2 つの請求明細行を持つ 1 つの請求書に統合されます。 請求書を作成するトランザクションがない場合、ジョブは請求書の作成をスキップします。

**ProcessRunner** の実行が完了すると、 **ProcessRunCaller** を呼び出して、終了時間が指定されてクローズされます。 **ProcessRunCaller** は、指定された終了時刻から24時間実行するタイマーを開始します。 タイマーが終了すると、 **ProcessRunCaller** が閉じられます。

請求書を作成するバッチ処理ジョブは、定期的なジョブです。 このバッチ処理を何度も実行すると、ジョブの複数のインスタンスが作成され、エラーが発生します。 したがって、バッチ処理は一度だけ実行し、実行が停止した場合のみ、再起動する必要があります。

> [!NOTE]
> Project Service Automation でのバッチ請求は、請求スケジュールによって構成されたプロジェクトの契約品目に対してのみ実行されます。 固定価格の請求方法の契約品目には、マイルストーンを構成する必要があります。 時間と材料の請求方法を持つプロジェクト契約品目には、日付ベースの請求スケジュールを設定する必要があります。 見積依頼明細行に基づくプロジェクトのコンテキストでの請求頻度の設定に関する情報は、トピック [見積もりと見積依頼明細行](basic-quote-lines.md#invoice-schedule) で提供されています。 これは、プロジェクトベースの契約品目でも同じです。      
 
### <a name="edit-a-draft-psa-invoice"></a>PSA 請求書の下書きを編集する

プロジェクト請求書のドラフトを作成すると、時間と経費のエントリが承認したときに作成された、すべての未請求営業トランザクションが、請求書にプルされます。 請求書がまだドラフト段階である間は、次の調整を行うことができます:

- 請求明細行の詳細を削除、または編集します。
- 数量や請求書の種類を編集、調整します。
- 請求書にトランザクションとして直接、時間、経費、手数料を追加します。 請求明細行が、これらの取引区分を許可する契約品目にマップされている場合、この機能が使用できます。

請求書を確認するには、 **確認** を選択します。 確認操作は、一方向の操作です。 **確認** を選択すると、システムは請求書を読み取り専用にし、各請求明細行の各請求明細行の詳細から請求済みの売上実績を作成します。 請求明細行の詳細が未請求売上実績を参照する場合、システムは未請求売上実績も取り消します。 (時間または経費エントリから作成された請求明細行の詳細は、未請求売上実績を参照します)。総勘定元帳統合システムは、この取り消しを使用して、会計目的で進行中のプロジェクト作業 (WIP) を取り消すことができます。

### <a name="correct-a-confirmed-psa-invoice"></a>確認済みのPSA請求書を修正する

確認済みのPSA請求書は編集 (修正) できます。 確認済みの請求書を修正すると、新規修正請求書ドラフトが作成されます。 元の請求書のすべてのトランザクションと数量を取り消すことを前提としているため、この修正請求書には元の請求書のすべてのトランザクションが含まれ、その数量はすべて 0 (ゼロ) になります。

トランザクションが修正を必要とない場合、その修正請求書のドラフトから削除できます。 部分的な数量を取り消す、または戻り場合は、明細行の詳細の **数量** フィールドを編集できます。 請求明細行の詳細を開くと、元の請求書の数量が表示されます。 その後、現在の請求書の数量を編集して、元の請求書の数量よりも少なく、または多くすることができます。

修正請求書を確認すると、元の請求済み売上実績が取り消され、新規の請求済み売上実績が作成されます。 数量が削減された場合、差異により未請求売上実績も作成されます。 たとえば、元の請求済み売上が 8 時間で、修正請求明細行の詳細の数量が 6 時間に減少した場合、PSAは元の請求済み売上品目を取り消し、新しい 2 つの実績を作成します:

- 6 時間の請求済み売上実績。
- 残り 2 時間の未請求売上実績。 このトランザクションは、顧客との交渉に応じて後で請求するか、または、請求不可としてマークすることができます。
