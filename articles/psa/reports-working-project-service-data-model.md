---
title: Project Service Automation データ モデルでの作業
description: この記事では、データ モデルでの作業方法について説明します。
author: ruhercul
ms.custom:
- dyn365-projectservice
ms.date: 03/01/2019
ms.topic: article
ms.author: ruhercul
audience: Admin
search.audienceType:
- admin
- customizer
- enduser
search.app:
- D365CE
- D365PS
- ProjectOperations
ms.reviewer: johnmichalak
ms.openlocfilehash: 67932eea78048c09f5f836d1330f412466622c6a
ms.sourcegitcommit: 6cfc50d89528df977a8f6a55c1ad39d99800d9b4
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 06/03/2022
ms.locfileid: "8926690"
---
# <a name="working-with-the-project-service-automation-data-model"></a>Project Service Automation データ モデルでの作業

[!include [banner](../includes/psa-now-project-operations.md)]

[!INCLUDE[cc-applies-to-psa-app-3.x](../includes/cc-applies-to-psa-app-3x.md)]


Dynamics 365 Project Service Automation はその他のアプリ エンティティを拡張子、Common Data Service データ モデルでの自分のエンティティを導入します。 この記事では、一般的な PSA レポート作成シナリオで発生する一部のエンティティについて説明します。

## <a name="reporting-on-opportunities"></a>営業案件でのレポート作成

Project Service Automation をプロジェクトベースのシナリオを有効にするフィールドを追加することで、Dynamics 365 Sales の **営業案件** エンティティを拡張します。 これらのフィールドは、**msdyn\_** を使用して接頭辞として付加されたスキーマ名によって識別されます。 PSA でのレポート作成に重要な一つの新しいフィールドは **受注の種類** です。 このフィールドの **作業ベース** の値は、この営業案件が PSA の営業案件であることを示します。 エンティティに追加されたその他のフィールドには、営業案件を持っている組織をキャプチャする **契約組織**、およびその営業案件を担当するアカウント マネージャーの名前をキャプチャする **アカウント マネージャー** が含まれます。

**営業案件品目** エンティティには、Project Service に関連するフィールドも含まれます。 **請求方法** は、営業案件品目が時間/実費払いベース、または固定価格ベースで請求されるべきかを示し、営業案件をバッキングするプロジェクトの名前をキャプチャする **プロジェクト** を示します。 レポートできるその他のフィールドは、明細行のコストと顧客予算額をキャプチャします。

## <a name="reporting-on-quotes"></a>見積もりのレポート

PSA は、プロジェクト関連フィールドを追加することで営業 **見積もり** エンティティを拡張します。 **受注の種類** は非 PSA 見積もりから PSA 見積もりを区別します。 このフィールドの **作業ベース** の値は、この見積もりが PSA 見積もりであることを示しています。 PSA でのレポート作成に関連する可能性があるその他のフィールドには、**請求可能コスト**、**請求不可コスト**、**粗利**、**見込み**、**予算** などの金額フィールドが含まれます。 その他の有用なフィールドは、この見積もりが利益になるかどうか、スケジュール通りに完了するかどうか、および顧客の予算の期待に合うかどうか示しています。

PSA は営業 **見積もり明細行** エンティティの拡張もおこないます。 PSA が追加する一つのフィールドは、見積もり明細行の請求方法を示す **請求方法** です (時間と資材または固定価格)。 エンティティに追加されているその他のフィールドは、見積もり明細行、請求、コスト、予算をバッキングする関連プロジェクトをキャプチャします。

PSA は、新規見積もり関連エンティティの Dynamics 365 データ モデルへの追加もします。 ここに例を示します。

- **見積もり明細行の詳細** – このエンティティは、見積もりの品目のプロジェクト見込みの詳細が含まれます。 これは、各見積もり明細行に二つのレコードがあります。 一つのレコードは見積もり明細行のコストとコスト詳細を保存し、その他のレコードは、見積もり明細行の販売価格と販売の詳細を保存します。
- **見積もり明細行の請求のスケジュール** – このエンティティには、見積もり明細行に対する請求スケジュールが含まれます。 このスケジュールは見積明細行に割り当てられた請求の頻度に基づいて生成されます。
- **見積もり品目のマイルストーン** – このエンティティには、固定価格の見積もり品目に対する請求のマイルストーンが含まれます。
- **見積もり依頼明細行の分析内訳** – このエンティティには、見積もり依頼明細行の財務的な詳細が含まれます。 これらの詳細は見積られた営業売上とさまざまなディメンションによって見積もられたコスト金額のレポート作成に役立てることができます。

PSA が見積もりに追加するその他のエンティティは、**見積もり依頼明細行のプロジェクト価格表**、**見積もり依頼明細行リソース カテゴリ**、および **見積もり依頼明細行のトランザクション カテゴリ** です。

![見積もり、見積依頼明細行、およびプロジェクト関係を示す図。](media/PS-Reporting-image2.png "見積もり、見積依頼明細行、およびプロジェクト関係を示す図")

## <a name="reporting-on-project-contracts"></a>プロジェクト契約のレポート

PSA は、プロジェクト契約が記録される際に使用される営業 **受注** エンティティを拡張します。 これは重要で新しいフィールドである、契約を受注の代わりに PSA プロジェクト契約として識別する **受注の種類** を追加します。 このフィールドの **作業ベース** の値は、この受注が PSA のプロジェクト契約であることを示しています。 **受注** エンティティに追加されたその他の新規フィールドは、コスト、PSA 契約の状態、契約を所有する組織についての詳細をキャプチャします。

PSA は **受注明細行** エンティティの拡張もおこないます。 追加するフィールドには、請求方法 (時間/実費払い、または固定価格)、顧客予算額、および元になるプロジェクトをキャプチャするフィールドです。

PSA は、プロジェクト契約用に設計された新しいエンティティも追加します。 ここに例を示します。

- **プロジェクト契約明細行の詳細** – このエンティティは、契約品目の金額に対してロールアップされる行レベルの詳細が含まれます。 これらはタスクレベルでのプロジェクト スケジュールから生成された品目と同じくらい詳細にできます。
- **契約品目を請求書スケジュール** – このエンティティは、契約品目に割り当てられた請求頻度に基づいて生成された請求書スケジュールが含まれます。
- **契約のマイルストーン** – このエンティティには、固定価格の請求条件を持つ契約品目のための請求マイルストーンが含まれます。

PSA が契約に追加するその他のエンティティは、**プロジェクト契約明細行のプロジェクト価格表**、**プロジェクト契約明細行リソース カテゴリ**、および **プロジェクト契約明細行のトランザクション カテゴリ** です。

![受注、受注明細行、およびプロジェクト関係を示す図。](media/PS-Reporting-image3.png "受注、受注明細行、およびプロジェクト関係を示す図")

## <a name="reporting-on-projects"></a>プロジェクトのレポート

**プロジェクト** エンティティおよび関連エンティティは PSA に限定しています。 **プロジェクト** は、作業と操作のコスト面をキャプチャするために使用される最上位のエンティティです。 こちらが関連エンティティのリストです:

- **プロジェクト チーム メンバー** – このエンティティは、プロジェクトに割り当てられている予約可能リソースに関する詳細が含まれます。 これらのリソースは、汎用予約可能リソースにすることも、プロジェクト マネージャーによって入力されるか、プロジェクト スケジュールから生成される名前の付いた予約可能リソースとすることもできます。
- **プロジェクト タスク** – このエンティティは、プロジェクト計画またはスケジュールを構成するタスクが含まれます。
- **リソースの割り当て** – このエンティティ–には、予約可能リソースのタスク割り当てが含まれます。
- **リソース要件** – このエンティティには、すべての汎用リソースのチーム メンバーの要件が含まれます。
- **見積もり** と **見積明細行** – これらのエンティティにヘッダー/明細行の関係が存在し、プロジェクトの経費見積を含みます。 タスク見積は、**リソースの予測** エンティティ上に保存されます。

![リソース要件およびプロジェクト関係を示す図。](media/PS-Reporting-image4.png "リソース要件およびプロジェクト関係を示す図")

## <a name="reporting-on-resources"></a>リソースのレポート

プロジェクト リソースは、Microsoft Dynamics 365 Field Service などのその他のアプリと共有される Universal Resource Scheduling (URS) から **予約可能リソース** エンティティを使用します。 プロジェクト リソース上でレポートする場合に使用する可能性があるエンティティのリストはこちらです:

- **予約可能リソース** – このエンティティは、プロジェクト チームで使用する、ユーザー、連絡先、汎用リソース、アカウント グループ、または備品を表します。
- **予約可能リソースの特製** – このエンティティには、リソースのスキル、証明、または教育が含まれます。 特性は評価モデルによって定義される評価値を持つことができます。
- **予約可能リソース カテゴリ** – このエンティティ–は、予約可能リソースのロールを表します。
- **予約可能リソースの予約** – このエンティティは、リソース用にプロジェクト上で予約される時間を表します。 各予約にはヘッダー エンティティと明細行エンティティの両方があり、各明細行は予約の状態を表すステータスを持っています。

![予約可能リソース特性関係を示す図。](media/PS-Reporting-image5.png "予約可能リソース特性関係を示す図")

## <a name="reporting-on-actual-transactions"></a>実績トランザクションのレポート

タイムシートまたは経費、あるいは PSA で契約を請求する場合は、ビジネス トランザクションは **実績** エンティティにキャプチャされます。 このエンティティは、PSA でのほぼすべての財務関連のレポートの基本として使用できます。 **実績** エンティティは、このビジネス イベントのコストと営業トランザクションをキャプチャします。 また、これは多くの関連属性もキャプチャします。

**実績** エンティティで作業する場合は、そのトランザクションがエンティティに記録され、いつトランザクションが記録されるかを理解することが重要です。 こちらが、時間入力と作業する場合の典型的なフローになります (経費エントリーのフローは同様です) :

1. 時間入力が保存された場合、**実績** エンティティでレコードは作成されません。
2. 時間入力が送信された場合、**実績** エンティティでレコードは作成されません。
3. 時間エントリが承認された場合は、1 つのレコードが **実績** エンティティで作成され、2 番目のレコードも作成されます。 最初のレコードは時間エントリのコストを保存します。 2 番目のレコードは時間エントリの未請求売上金額を保存します。 2 番目のレコードは、顧客、見積もり、またはそのチームに割り当てられた契約明細行のいずれかを持つプロジェクトに依存します。

    | ドキュメントの日付 | トランザクションの種類 | トランザクション クラス | Customer         | 契約   | リソース     | リソース ロール | 請求の種類 | 数量 | 単価 | [金額] |
    |---------------|------------------|-------------------|------------------|------------|--------------|---------------|--------------|----------|------------|--------|
    | 18/2/3        | コスト             | Time              | Alpine のスキー ハウス | Alpine CRM | 藤戸 茜 | プロジェクト マネージャー   | 請求可能   | 8.0      | 50.00      | 400.00 |
    | 18/2/3        | 未請求売上   | Time              | Alpine のスキー ハウス | Alpine CRM | 藤戸 茜 | プロジェクト マネージャー   | 請求可能   | 8.0      | 100.00     | 800.00 |

    これら二つのレコードは別々ですが、関連したレコードです。 これらのレコードは、またはデビットでも、クレジットでもありません。

4. 契約がプロジェクトに関連付けられた場合、時間入力が関与する場合、二つ以上のレコードが **実績** エンティティで作成されます。 まず、未請求の売上記録のマイナスの金額が作成されます。 このレコードは本質的に未請求売上を反転します。 次に、請求済み売上のトランザクションが作成されます。 先ほどと同じく、これらのレコードは別々ですが関連したレコードであり、デビットでもクレジットでもありません。

    | ドキュメントの日付 | トランザクションの種類 | トランザクション クラス | Customer         | 契約   | リソース     | リソース ロール | 請求の種類 | 数量 | 単価 | [金額]   |
    |---------------|------------------|-------------------|------------------|------------|--------------|---------------|--------------|----------|------------|----------|
    | 18/2/4        | 未請求売上   | Time              | Alpine のスキー ハウス | Alpine CRM | 藤戸 茜 | プロジェクト マネージャー   | 請求可能   | - 8.0    | 100.00     | - 800.00 |
    | 18/2/4        | 請求済み売上     | Time              | Alpine のスキー ハウス | Alpine CRM | 藤戸 茜 | プロジェクト マネージャー   | 請求可能   | 8.0      | 100.00     | 800.00   |

**トランザクションの発生元** エンティティは **実績** レコードの発生元を記録し、**トランザクション コネクション** エンティティは **実績** レコードの関連レコードを記録します。 さらに、**実績** レコードには、プロジェクト、プロジェクト契約 (注文)、予約可能リソースと顧客が含まれています。

![トランザクション コネクション、発生元、実績関係を示す図。](media/PS-Reporting-image6.png "トランザクション コネクション、発生元、実績関係を示す図")


[!INCLUDE[footer-include](../includes/footer-banner.md)]
