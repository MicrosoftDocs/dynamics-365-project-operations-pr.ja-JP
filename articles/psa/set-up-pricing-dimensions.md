---
title: 価格ディメンションとしてカスタム フィールドを設定する
description: このトピックではカスタム価格ディメンションのセットアップについて説明します。
author: Rumant
ms.custom:
- dyn365-projectservice
ms.date: 11/20/2018
ms.topic: article
ms.author: rumant
audience: Admin
search.audienceType:
- admin
- customizer
- enduser
search.app:
- D365PS
- ProjectOperations
ms.openlocfilehash: 9503b6528f91f86cc1ebe1c7ed6111171e74c4a3cbf83b3f68810c3ee5efdd28
ms.sourcegitcommit: 7f8d1e7a16af769adb43d1877c28fdce53975db8
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/06/2021
ms.locfileid: "7002337"
---
# <a name="setting-up-custom-fields-as-pricing-dimensions"></a>価格ディメンションとしてカスタム フィールドを設定する 

[!include [banner](../includes/psa-now-project-operations.md)]

開始する前に、このトピックはユーザーがこれらのトピックの手順を完了していることを前提としています: [カスタム フィールドおよびエンティティを作成する](create-custom-fields-entities.md) および[価格設定とトランザクション エンティティに対してユカスタム フィールドを追加する](field-references.md) 次に、これらの手順を完了していない場合は、戻ってこれらを完了してから、このトピックに戻ってください。 

このトピックではカスタム価格ディメンションのセットアップについて説明します。 Project Service Web インターフェイスでは、**パラメーター** ページの **金額ベースの価格ディメンション** タブに、価格ディメンション エンティティのレコードが表示されます。 既定では、Project Service のインストールによって、このタブのグリッドには二つの行が作成されます。

- **msdyn_resourcecategory** (ロール)
- **msdyn_OrganizationalUnit** (組織単位)

> [!IMPORTANT]
> これらの行を削除しないでください。 ただし、これらが必要ない場合は、 **コストに適用可能**、**営業に適用可能**、**購入に適用可能** をすべて **いいえ** に設定することによって特定のコンテキストでは適用されないように設定できます。 これらの属性値を **いいえ** に設定すると、価格ディメンションとしてのフィールドがないのと同じ結果になります。

価格ディメンションにするフィールドに関して、次のようにする必要があります:

- **ロール価格** および **ロール価格の利幅** エンティティでフィールドを作成します。 この方法についての詳細は、[価格設定とトランザクション エンティティに対してカスタム フィールドを追加する](field-references.md)を参照してください。
- **価格ディメンション** テーブルに行が作成されました たとえば、次のグラフィックに示すように、価格ディメンションの行を追加します。 

![合計金額ベースの価格ディメンションの行。](media/Amt-based-PD.png)

注意: リソースの作業時間 (**msdyn_resourceworkhours**)は 利幅ベースのディメンションとして追加され、また、 **利幅ベースの価格ディメンション** タブに追加されました。

![利幅ベースの価格ディメンションの行。](media/Markup-based-PD.png)

> [!IMPORTANT]
> このテーブルの価格ディメンション データに対する変更は、既存か新規かに関わらず、キャッシュを更新した後、Project Service 価格設定のビジネス ロジックに伝播されます。 キャッシュの更新時間は最大で10分かかる場合があります。 この時間を使って、価格ディメンション データに対する変更に明らかに起因する既定の価格設定ロジックの変更を確認します。


## <a name="attributes-of-the-pricing-dimensions-table"></a>価格ディメンション テーブルの属性
次のセクションでは、**価格ディメンション** テーブルのさまざまな属性について説明します。

### <a name="pricing-dimension-name"></a>価格ディメンションの名前
この値は、カスタム価格ディメンションの **ロール価格** テーブルに追加されているフィールドのスキーマ名と同一である必要があります。 フィールドを **ロール価格** テーブルに追加する方法の詳細については、[価格設定およびトランザクション エンティティにユーザー定義フィールドを追加する](field-references.md) を参照してください。

### <a name="type-of-dimension"></a>ディメンションの種類
価格ディメンションには 2 種類あります。
  
  - **金額ベースのディメンション**: 入力コンテキストからのディメンション値は、**ロール価格** 行のディメンション値に一致し、価格/コストは、既定になって **ロール価格** テーブルから直接取得されます。
  - **利幅ベースのディメンション**: Project Service は、次の 3 段階ステップのプロセスが適用された、価格/コストを得るディメンションです。
 
    1. Project Service では、入力コンテキストから非利幅ベースのディメンション値をロール価格行に一致させて、基本料金を取得します。
    2. Project Service では、入力コンテキストからすべてのディメンション値を **ロール価格利幅** 行に一致させて、利幅率を取得できます。
    3. Project Service では、2 番目の手順で得た利幅率を、最初の手順の **価格ロール** テーブルで取得済みの基本料金に適用して、最終的な価格/コストを算出します。
   
   次の表は、価格利幅の計算について説明したものです。
  
| ロール        | 組織単位    |作業場所      |標準タイトル      |リソースの作業時間      |  利幅|
| ------------|-------------|-------------------|--------------------|-------------------------|--------:|
|             | Contoso India|オンサイト            |                    |残業                 |15     |
|             | Contoso India|ローカル             |                    |残業                 |10     |
|             | Contoso US   |ローカル             |                    |残業                 |20     |


Contoso India の基本料金が 100 米国ドルのリソースがオンサイトで従事していて、時間エントリで 8 時間の標準時間および 2 時間の残業をログした場合、Project Service の価格設定エンジンは 8 時間に 100 の基本料金を使用して 800 米国ドルを記録します。 残業時間 2 時間に関しては、15% の利幅が 100 の基本料金に適用され、115 米国ドルの単価を取得し、230 米国ドルの合計コストを記録します。

### <a name="applicable-to-cost"></a>コストに適用可能 
これを **はい** に設定する場合、コストと利幅レートを取得する際に、入力コンテキストのディメンション値を **ロール価格** および **ロール価格の利幅** に一致させるように使用する必要があるということが示されています。

### <a name="applicable-to-sales"></a>営業に適用可能
これを **はい** に設定する場合、請求書と利幅レートを取得する際に、入力コンテキストのディメンション値を **価格ロール** および **ロール価格の利幅** と一致させるように使用する必要があるということが示されています。

### <a name="applicable-to-purchase"></a>購入に適用可能
これを **はい** に設定する場合、購入価格を取得する際に、入力コンテキストのディメンション値を **ロール価格** および **ロール価格の利幅** と一致させるように使用する必要があるということが示されています。 現在の Project Service は下請けシナリオをサポートしないため、このフィールドは使用されません。 

### <a name="priority"></a>重要度
**ロール価格** または **ロール価格値幅** テーブルの入力ディメンション値と値の間で完全一致が見つからなくても、ディメンションのプライマリを設定をすることによって、Project Service 価格設定で価格を提供するのに役立ちます。 このシナリオでは、Project Service によりディメンションが優先順位の順で重要視され、一致しないディメンション値に対しては null 値が使用されます。

- **コストの優先度**: ディメンションのコストの優先度の値は、原価価格の設定と一致する場合のディメンションの重要度を示します。 **コストの優先度** の値は、 **コストに適用可能** なディメンション全体で一意である必要があります。
- **営業の優先度**: ディメンションの営業の優先度の値は、販売価格または請求レートの設定と一致する場合のディメンションの重要度を示します。 **営業の優先度** の値は、 **営業に適用可能** であるディメンション全体で一意である必要があります。


[!INCLUDE[footer-include](../includes/footer-banner.md)]